function SmartWizard(a,b){this.target=a,this.options=b,this.curStepIdx=b.selected,this.steps=$(a).children("ul").children("li").children("a"),this.contentWidth=0,this.msgBox=$('<div class="msgBox"><div class="content"></div><a href="#" class="close">X</a></div>'),this.elmStepContainer=$("<div></div>").addClass("stepContainer"),this.loader=$("<div>Loading</div>").addClass("loader"),this.buttons={next:$("<a>"+b.labelNext+"</a>").attr("href","#").addClass("buttonNext"),previous:$("<a>"+b.labelPrevious+"</a>").attr("href","#").addClass("buttonPrevious"),finish:$("<a>"+b.labelFinish+"</a>").attr("href","#").addClass("buttonFinish")};var c=function(b){var c=$("<div></div>").addClass("actionBar");c.append(b.msgBox),$(".close",b.msgBox).on("click",function(){return b.msgBox.fadeOut("normal"),!1});var e=b.target.children("div");if(0==b.target.children("ul").length){var g=$("<ul/>");a.prepend(g),e.each(function(a,b){var c=$(b).first().children(".StepTitle").text(),d=$(b).attr("id");void 0==d&&(d="step-"+(a+1),$(b).attr("id",d));var e=$("<span/>").addClass("stepDesc").text(c),f=$("<li></li>").append($("<a></a>").attr("href","#"+d).append($("<label></label>").addClass("stepNumber").text(a+1)).append(e));g.append(f)}),b.steps=$(a).children("ul").children("li").children("a")}b.target.children("ul").addClass("anchor"),e.addClass("content"),b.options.errorSteps&&b.options.errorSteps.length>0&&$.each(b.options.errorSteps,function(a,c){b.setError({stepnum:c,iserror:!0})}),b.elmStepContainer.append(e),c.append(b.loader),b.target.append(b.elmStepContainer),b.options.includeFinishButton&&c.append(b.buttons.finish),c.append(b.buttons.next).append(b.buttons.previous),b.target.append(c),this.contentWidth=b.elmStepContainer.width(),$(b.buttons.next).on("click",function(){return b.goForward(),!1}),$(b.buttons.previous).on("click",function(){return b.goBackward(),!1}),$(b.buttons.finish).on("click",function(){if(!$(this).hasClass("buttonDisabled"))if($.isFunction(b.options.onFinish)){var a={fromStep:b.curStepIdx+1};if(!b.options.onFinish.call(this,$(b.steps),a))return!1}else{var c=b.target.parents("form");c&&c.length&&c.submit()}return!1}),$(b.steps).bind("click",function(a){if(b.steps.index(this)==b.curStepIdx)return!1;var c=b.steps.index(this),d=b.steps.eq(c).attr("isDone")-0;return 1==d&&f(b,c),!1}),b.options.keyNavigation&&$(document).keyup(function(a){39==a.which?b.goForward():37==a.which&&b.goBackward()}),d(b),f(b,b.curStepIdx)},d=function(a){a.options.enableAllSteps?($(a.steps,a.target).removeClass("selected").removeClass("disabled").addClass("done"),$(a.steps,a.target).attr("isDone",1)):($(a.steps,a.target).removeClass("selected").removeClass("done").addClass("disabled"),$(a.steps,a.target).attr("isDone",0)),$(a.steps,a.target).each(function(b){$($(this).attr("href").replace(/^.+#/,"#"),a.target).hide(),$(this).attr("rel",b+1)})},e=function(a,b){return $($(b,a.target).attr("href").replace(/^.+#/,"#"),a.target)},f=function(a,b){var c=a.steps.eq(b),d=a.options.contentURL,f=a.options.contentURLData,h=c.data("hasContent"),i=b+1;if(d&&d.length>0)if(a.options.contentCache&&h)g(a,b);else{var j={url:d,type:a.options.ajaxType,data:{step_number:i},dataType:"text",beforeSend:function(){a.loader.show()},error:function(){a.loader.hide()},success:function(d){a.loader.hide(),d&&d.length>0&&(c.data("hasContent",!0),e(a,c).html(d),g(a,b))}};f&&(j=$.extend(j,f(i))),$.ajax(j)}else g(a,b)},g=function(a,b){var c=a.steps.eq(b),d=a.steps.eq(a.curStepIdx);if(b!=a.curStepIdx&&$.isFunction(a.options.onLeaveStep)){var f={fromStep:a.curStepIdx+1,toStep:b+1};if(!a.options.onLeaveStep.call(a,$(d),f))return!1}var g=a.curStepIdx;if(a.curStepIdx=b,"slide"==a.options.transitionEffect)e(a,d).slideUp("fast",function(b){e(a,c).slideDown("fast"),h(a,d,c)});else if("fade"==a.options.transitionEffect)e(a,d).fadeOut("fast",function(b){e(a,c).fadeIn("fast"),h(a,d,c)});else if("slideleft"==a.options.transitionEffect){var j=null,k=0;b>g?(j=a.elmStepContainer.width()+10,nextElmLeft2=0,k=0-e(a,d).outerWidth()):(j=0-e(a,c).outerWidth()+20,nextElmLeft2=0,k=10+e(a,d).outerWidth()),b==g?(j=$($(c,a.target).attr("href"),a.target).outerWidth()+20,nextElmLeft2=0,k=0-$($(d,a.target).attr("href"),a.target).outerWidth()):$($(d,a.target).attr("href"),a.target).animate({left:k},"fast",function(b){$($(d,a.target).attr("href"),a.target).hide()}),e(a,c).css("left",j).show().animate({left:nextElmLeft2},"fast",function(b){h(a,d,c)})}else e(a,d).hide(),e(a,c).show(),h(a,d,c);return!0},h=function(a,b,c){if($(b,a.target).removeClass("selected"),$(b,a.target).addClass("done"),$(c,a.target).removeClass("disabled"),$(c,a.target).removeClass("done"),$(c,a.target).addClass("selected"),$(c,a.target).attr("isDone",1),i(a),$.isFunction(a.options.onShowStep)){var d={fromStep:parseInt($(b).attr("rel")),toStep:parseInt($(c).attr("rel"))};if(!a.options.onShowStep.call(this,$(c),d))return!1}if(a.options.noForwardJumping)for(var e=a.curStepIdx+2;e<=a.steps.length;e++)a.disableStep(e)},i=function(a){a.options.cycleSteps||(0>=a.curStepIdx?($(a.buttons.previous).addClass("buttonDisabled"),a.options.hideButtonsOnDisabled&&$(a.buttons.previous).hide()):($(a.buttons.previous).removeClass("buttonDisabled"),a.options.hideButtonsOnDisabled&&$(a.buttons.previous).show()),a.steps.length-1<=a.curStepIdx?($(a.buttons.next).addClass("buttonDisabled"),a.options.hideButtonsOnDisabled&&$(a.buttons.next).hide()):($(a.buttons.next).removeClass("buttonDisabled"),a.options.hideButtonsOnDisabled&&$(a.buttons.next).show())),a.enableFinish(a.options.enableFinishButton)};SmartWizard.prototype.goForward=function(){var a=this.curStepIdx+1;if(this.steps.length<=a){if(!this.options.cycleSteps)return!1;a=0}f(this,a)},SmartWizard.prototype.goBackward=function(){var a=this.curStepIdx-1;if(0>a){if(!this.options.cycleSteps)return!1;a=this.steps.length-1}f(this,a)},SmartWizard.prototype.goToStep=function(a){var b=a-1;b>=0&&b<this.steps.length&&f(this,b)},SmartWizard.prototype.enableStep=function(a){var b=a-1;if(b==this.curStepIdx||b<0||b>=this.steps.length)return!1;var c=this.steps.eq(b);$(c,this.target).attr("isDone",1),$(c,this.target).removeClass("disabled").removeClass("selected").addClass("done")},SmartWizard.prototype.disableStep=function(a){var b=a-1;if(b==this.curStepIdx||b<0||b>=this.steps.length)return!1;var c=this.steps.eq(b);$(c,this.target).attr("isDone",0),$(c,this.target).removeClass("done").removeClass("selected").addClass("disabled")},SmartWizard.prototype.currentStep=function(){return this.curStepIdx+1},SmartWizard.prototype.showMessage=function(a){$(".content",this.msgBox).html(a),this.msgBox.show()},SmartWizard.prototype.enableFinish=function(a){return this.options.enableFinishButton=a,this.options.includeFinishButton&&(!this.steps.hasClass("disabled")||this.options.enableFinishButton?($(this.buttons.finish).removeClass("buttonDisabled"),this.options.hideButtonsOnDisabled&&$(this.buttons.finish).show()):($(this.buttons.finish).addClass("buttonDisabled"),this.options.hideButtonsOnDisabled&&$(this.buttons.finish).hide())),this.options.enableFinishButton},SmartWizard.prototype.hideMessage=function(){this.msgBox.fadeOut("normal")},SmartWizard.prototype.showError=function(a){this.setError(a,!0)},SmartWizard.prototype.hideError=function(a){this.setError(a,!1)},SmartWizard.prototype.setError=function(a,b){"object"==typeof a&&(b=a.iserror,a=a.stepnum),b?$(this.steps.eq(a-1),this.target).addClass("error"):$(this.steps.eq(a-1),this.target).removeClass("error")},SmartWizard.prototype.fixHeight=function(){var a=0,b=this.steps.eq(this.curStepIdx),c=e(this,b);c.children().each(function(){$(this).is(":visible")&&(a+=$(this).outerHeight(!0))}),c.height(a+5),this.elmStepContainer.height(a+20)},c(this)}!function(a){a.fn.smartWizard=function(b){var c=arguments,d=void 0,e=this.each(function(){var e=a(this).data("smartWizard");if("object"!=typeof b&&b&&e){if("function"==typeof SmartWizard.prototype[b])return d=SmartWizard.prototype[b].apply(e,Array.prototype.slice.call(c,1));a.error("Method "+b+" does not exist on jQuery.smartWizard")}else{var f=a.extend({},a.fn.smartWizard.defaults,b||{});e||(e=new SmartWizard(a(this),f),a(this).data("smartWizard",e))}});return void 0===d?e:d},a.fn.smartWizard.defaults={selected:0,keyNavigation:!0,enableAllSteps:!1,transitionEffect:"fade",contentURL:null,contentCache:!0,cycleSteps:!1,enableFinishButton:!1,hideButtonsOnDisabled:!0,errorSteps:[],labelNext:"Next",labelPrevious:"Previous",labelFinish:"Finish",noForwardJumping:!1,ajaxType:"POST",onLeaveStep:null,onShowStep:null,onFinish:null,includeFinishButton:!0}}(jQuery);