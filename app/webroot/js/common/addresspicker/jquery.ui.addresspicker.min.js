!function(a,b){a.widget("ui.addresspicker",{options:{appendAddressString:"",draggableMarker:!0,regionBias:null,bounds:"",componentsFilter:"",updateCallback:null,reverseGeocode:!0,autocomplete:"default",language:"en",mapOptions:{backgroundColor:"#ffffff",zoom:5,disableDefaultUI:!0,center:new google.maps.LatLng(46,2),scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"landscape.man_made",stylers:[{color:"#ffffff"},{visibility:"off"}]},{featureType:"water",stylers:[{color:"#80C8E5"},{saturation:0}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#999999"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{elementType:"labels.text",stylers:[{color:"#333333"}]},{featureType:"road.local",stylers:[{color:"#dedede"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{color:"#666666"}]},{featureType:"transit.station.bus",stylers:[{saturation:-57}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"poi",stylers:[{visibility:"off"}]}]},elements:{map:!1,lat:!1,lng:!1,street_number:!1,route:!1,locality:!1,sublocality:!1,administrative_area_level_3:!1,administrative_area_level_2:!1,administrative_area_level_1:!1,country:!1,postal_code:!1,type:!1},autocomplete:""},marker:function(){return this.gmarker},map:function(){return this.gmap},updatePosition:function(){this._updatePosition(this.gmarker.getPosition())},reloadPosition:function(){this.gmarker.setVisible(!0),this.gmarker.setPosition(new google.maps.LatLng(this.lat.val,this.lng.val)),this.gmap.setCenter(this.gmarker.getPosition())},resize:function(){google.maps.event.trigger(this.gmap,"resize")},selected:function(){return this.selectedResult},_mapped:{},_create:function(){var b=this;this.geocoder={geocode:function(a,b){jQuery.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?"+jQuery.param(a),type:"GET",success:function(a){b(a.results,a.status)}})}},"bootstrap"===this.options.autocomplete?this.element.typeahead({source:function(a,c){b._mapped={};var d=function(a){for(var d=[],e=0;e<a.length;e++)b._mapped[a[e].label]=a[e],d.push(a[e].label);c(d)},e={term:a};b._geocode(e,d)},updater:function(a){var c={item:b._mapped[a]};return b._focusAddress(null,c),b._selectAddress(null,c),a}}):this.element.autocomplete(a.extend({source:a.proxy(this._geocode,this),focus:a.proxy(this._focusAddress,this),select:a.proxy(this._selectAddress,this)}),this.options.autocomplete),this.lat=a(this.options.elements.lat),this.lng=a(this.options.elements.lng),this.street_number=a(this.options.elements.street_number),this.route=a(this.options.elements.route),this.locality=a(this.options.elements.locality),this.sublocality=a(this.options.elements.sublocality),this.administrative_area_level_3=a(this.options.elements.administrative_area_level_3),this.administrative_area_level_2=a(this.options.elements.administrative_area_level_2),this.administrative_area_level_1=a(this.options.elements.administrative_area_level_1),this.country=a(this.options.elements.country),this.postal_code=a(this.options.elements.postal_code),this.type=a(this.options.elements.type),this.options.elements.map&&(this.mapElement=a(this.options.elements.map),this._initMap())},_initMap:function(){this.lat&&this.lat.val()&&(this.options.mapOptions.center=new google.maps.LatLng(this.lat.val(),this.lng.val())),this.gmap=new google.maps.Map(this.mapElement[0],this.options.mapOptions),this.gmarker=new google.maps.Marker({position:this.options.mapOptions.center,map:this.gmap,draggable:this.options.draggableMarker}),google.maps.event.addListener(this.gmarker,"dragend",a.proxy(this._markerMoved,this)),this.gmarker.setVisible(!1)},_updatePosition:function(a){this.lat&&this.lat.val(a.lat()),this.lng&&this.lng.val(a.lng())},_addressParts:{street_number:null,route:null,locality:null,sublocality:null,administrative_area_level_3:null,administrative_area_level_2:null,administrative_area_level_1:null,country:null,postal_code:null,type:null},_updateAddressParts:function(a){parsedResult=this._parseGeocodeResult(a);for(addressPart in this._addressParts)this[addressPart]&&(parsedResult[addressPart]!==!1?this[addressPart].val(parsedResult[addressPart]):this[addressPart].val(""))},_updateAddressPartsViaReverseGeocode:function(b){this.geocoder.geocode({latlng:b.lat()+","+b.lng()},a.proxy(function(a,b){b==google.maps.GeocoderStatus.OK&&(this._updateAddressParts(a[0]),this.element.val(a[0].formatted_address),this.selectedResult=a[0],this.options.updateCallback&&this.options.updateCallback(this.selectedResult,this._parseGeocodeResult(this.selectedResult)))},this))},_parseGeocodeResult:function(a){var b=this._parseLatAndLng(a.geometry.location);for(var c in this._addressParts)b[c]=this._findInfo(a,c);return b.type=a.types[0],b},_parseLatAndLng:function(a){var b,c;return"function"==typeof a.lat?(c=a.lat(),b=a.lng()):(c=a.lat,b=a.lng),{lat:c,lng:b}},_markerMoved:function(){this._updatePosition(this.gmarker.getPosition()),this.options.reverseGeocode&&this._updateAddressPartsViaReverseGeocode(this.gmarker.getPosition())},_geocode:function(a,b){var c=a.term;this.geocoder.geocode({language:this.options.language,address:c+this.options.appendAddressString,region:this.options.regionBias,bounds:this.options.bounds,components:this.options.componentsFilter},function(a,c){if(c==google.maps.GeocoderStatus.OK&&a)for(var d=0;d<a.length;d++)result=a[d],g=result.geometry,g.location=new google.maps.LatLng(g.location.lat,g.location.lng),g.viewport=new google.maps.LatLngBounds(new google.maps.LatLng(g.viewport.southwest.lat,g.viewport.southwest.lng),new google.maps.LatLng(g.viewport.northeast.lat,g.viewport.northeast.lng)),result.label=a[d].formatted_address;b(a)})},_findInfo:function(a,b){for(var c=0;c<a.address_components.length;c++){var d=a.address_components[c];if(d.types.indexOf(b)!=-1)return d.long_name}return!1},_focusAddress:function(a,b){var c=b.item;c&&(this.gmarker&&(this.gmarker.setPosition(c.geometry.location),this.gmarker.setVisible(!0),this.gmap.fitBounds(c.geometry.viewport)),this._updatePosition(c.geometry.location),this._updateAddressParts(c))},_selectAddress:function(a,b){this.selectedResult=b.item,this.options.updateCallback&&this.options.updateCallback(this.selectedResult,this._parseGeocodeResult(this.selectedResult))}}),a.extend(a.ui.addresspicker,{version:"@VERSION"}),Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1})}(jQuery);